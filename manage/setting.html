<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./../css/bootstrap.min.css" type="text/css" />
        <link rel="stylesheet" href="./../css/reserv.css" type="text/css" />
        <script type="text/javascript" src="./../js/bootstrap.min.js"></script>
        <script type="text/javascript" src="./../js/jquery.min.js"></script>
        <script type="text/javascript" defer src="./../js/reserv.js"></script>
        <title>シフト予約システム｜管理｜月度シフト予約事前設定</title>
    </head>
    <body>
        <div class="row">
            <!-- 左余白 -->
            <div class="col-md-2"></div>
            <!-- メインコンテンツ -->
            <div class="col-md-8">
                <h1>月度シフト予約事前設定</h1>
                <div class="progress progress-striped active">
<?php
    if (isset($_POST["res_s"], $_POST["res_e"], $_POST["rec_s"], $_POST["rec_e"]) ) {
        $ps_value = 50;
        $date_form_enabled = false;
    } else {
        $ps_value = 20;
        $date_form_enabled = true;
    }
?>
                    <div class="progress-bar progress-bar-info"  role="progressbar" aria-valuenow="<?php echo $ps_value; ?>" aria-valuemin="0" aria-valuemax="100" style="width: <?php echo $ps_value; ?>%">
                        <span class="sr-only"><?php echo $ps_value; ?>% Complete</span>
                    </div>
                </div>
                <!-- 予約設定 -->
                <form method="post" action="">
                    <h4>１．シフト予約として、募集するはじめ・おわりの日付を指定してください。</h4>
                    <div class="row">
                        <label for="reserv">対象予約期間</label>
                        <div class="form-group">
                            <div class="col-md-6">
                                <input type="date" class="form-control" id="reserv" name="res_s" placeholder="西暦年-月-日" required <?php if (! $date_form_enabled) echo "disabled" ?> />
                                <span class="help-block">開始日</span>
                            </div>
                            <div class="col-md-6">
                                <input type="date" class="form-control" id="reserv" name="res_e" placeholder="西暦年-月-日" required <?php if (! $date_form_enabled) echo "disabled" ?> />
                                <span class="help-block">終了日</span>
                            </div>
                        </div>
                    </div>
                    <h4>２．シフト予約を募集する期間を設定してください。</h4>
                    <div class="row">
                        <label for="reserv">予約募集期間</label>
                        <div class="form-group">
                            <div class="col-md-6">
                                <input type="date" class="form-control" id="reserv" name="rec_s" placeholder="西暦年-月-日" required <?php if (! $date_form_enabled) echo "disabled" ?> />
                                <span class="help-block">開始日</span>
                            </div>
                            <div class="col-md-6">
                                <input type="date" class="form-control" id="reserv" name="rec_e" placeholder="西暦年-月-日" required <?php if (! $date_form_enabled) echo "disabled" ?> />
                                <span class="help-block">終了日</span>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-default pull-right"><?php if ($date_form_enabled) { echo "確定"; } else { echo "再設定"; } ?></button>
                </form>
            </div>
            <!-- 右余白 -->
            <div class="col-md-2">　</div>
        </div>
                <!-- ここで一旦PHP処理で上記formをdisabledにする
                     そのあとで、PHPにてカレンダー（シフト予約の）を出力し、休業時間を指定 -->
<?php
    if (isset($_POST["res_s"], $_POST["res_e"], $_POST["rec_s"], $_POST["rec_e"]) ) {
        include_once('./../core/make_grid.php');
        date_default_timezone_set("Asia/Tokyo");
    
        if (strtotime($_POST["res_s"]) > strtotime($_POST["res_e"]) | strtotime($_POST["rec_s"]) > strtotime($_POST["rec_e"]) ) {
            // 日付設定がおかしい
        } else {
            make_grid($_POST["res_s"], $_POST["res_e"]);
?>
        <form method="post" action="./../core/reserv.php" id="set" name="set" onSubmit="return getdata();">
            <input type="hidden" name="res_s" value=<?php echo "\"".$_POST["res_s"]."\""; ?> />
            <input type="hidden" name="res_e" value=<?php echo "\"".$_POST["res_e"]."\""; ?> />
            <input type="hidden" name="rec_s" value=<?php echo "\"".$_POST["rec_s"]."\""; ?> />
            <input type="hidden" name="rec_e" value=<?php echo "\"".$_POST["rec_e"]."\""; ?> />
            <div style="text-align: center">
                <button type="submit" id="btn-state" data-loading-text="処理中..." class="btn btn-primary btn-lg">
                    決　定
                </button>
            </div>
        </form>
<?php
        }
    }
?>
    </body>
</html>